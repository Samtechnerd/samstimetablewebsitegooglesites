<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Timetable</title>
    
    <style>
        /* BASE STYLES & THEME */
        :root {
            --color-dark-background: #121212; --color-card-background: #2b2b2b;
            --color-sidebar-background: #1e1e1e; --color-text-light: #ffffff;
            --color-text-dim: #ccc; --color-accent-blue: #4a90e2; 
            --sidebar-width: 280px; --border-radius-large: 16px; --border-radius-small: 8px;
        }
        body { margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--color-dark-background); color: var(--color-text-light); overflow-x: hidden; }
        #weather-app { display: flex; min-height: 100vh; }

        /* SIDEBAR STYLING */
        #sidebar { 
            width: var(--sidebar-width); 
            background-color: var(--color-sidebar-background); 
            padding: 20px 0; 
            display: flex; 
            flex-direction: column; 
            border-radius: 0 var(--border-radius-large) var(--border-radius-large) 0; 
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5); 
            z-index: 10;
            position: sticky; top: 0; height: 100vh;
        }
        .logo-container { width: 80px; height: 80px; margin: 0 auto 10px; border-radius: 50%; display: flex; justify-content: center; align-items: center; background-color: #333; }
        .logo-text { font-size: 40px; } 
        #station-header h1 { font-size: 1.4em; font-weight: 300; text-align: center; margin-bottom: 25px; color: var(--color-text-dim); }
        
        /* NAV LIST */
        nav ul { 
            list-style: none; padding: 0; width: 100%; 
            flex-grow: 1; overflow-y: auto;
        }
        .nav-item { padding: 10px 20px 10px 50px; cursor: pointer; transition: background-color 0.2s; margin: 5px 0; padding-right: 20px; }
        .nav-item a { color: var(--color-text-dim); text-decoration: none; display: block; font-size: 1.1em; }
        .active-page { 
            background-color: var(--color-accent-blue); 
            border-radius: 0 25px 25px 0; 
            margin-right: 10px; 
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3); 
        }
        .active-page a { color: var(--color-text-light); }
        
        #info-section { margin-top: auto; }
        #info-section, #dark-mode-toggle { padding: 10px 20px 10px 50px; cursor: pointer; font-size: 0.9em; opacity: 0.7; }
        
        /* MAIN DASHBOARD CONTENT */
        #dashboard-content { flex-grow: 1; padding: 30px; max-width: 1000px; margin: 0 auto; }
        .alert-card { background-color: var(--color-card-background); border-radius: var(--border-radius-small); padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); border-left: 8px solid; transition: all 0.3s ease; }
        .alert-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .alert-level { font-weight: bold; padding: 5px 10px; border-radius: 4px; text-transform: uppercase; text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.3); }
        .alert-headline { font-size: 1.4em; font-weight: 600; margin-top: 5px; }
        .alert-details { font-size: 0.9em; margin-top: 10px; line-height: 1.5; }

        /* PROGRESS BAR STYLES */
        .progress-section { margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1); }
        .progress-info { display: flex; justify-content: space-between; font-size: 0.9em; margin-bottom: 6px; font-weight: bold; color: #fff; }
        .progress-track { width: 100%; height: 8px; background-color: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; background-color: #fff; width: 0%; transition: width 0.5s ease; }

        /* RESPONSIVE */
        @media (max-width: 600px) {
            #weather-app { flex-direction: column; } 
            #sidebar { width: 100%; border-radius: 0; padding: 10px 0; position: static; height: auto; }
            #station-header h1, #info-section { display: none; }
            #station-header { text-align: center; margin: 0 auto; }
            nav ul { display: flex; justify-content: space-around; padding: 0 10px; overflow-x: auto; white-space: nowrap; flex-grow: 0; overflow-y: hidden; }
            .nav-item { padding: 5px 10px; margin: 0; flex-shrink: 0; }
            .active-page { margin-right: 0; border-radius: var(--border-radius-small); }
            #dashboard-content { padding: 15px; max-width: none; margin: 0; }
            .alert-header { flex-direction: column; align-items: flex-start; }
            .alert-times { margin-top: 10px; font-size: 0.8em; }
        }

        /* LIGHT MODE */
        body.light-mode {
            --color-dark-background: #f4f7f6; --color-card-background: #ffffff;
            --color-text-light: #333333; --color-sidebar-background: #eeeeee;
            --color-text-dim: #555555;
            background-color: var(--color-dark-background);
            color: var(--color-text-light);
        }
        body.light-mode #sidebar { background-color: var(--color-sidebar-background); box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1); }
        body.light-mode .alert-card { background-color: var(--color-card-background); box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05); }
        body.light-mode #station-header h1 { color: var(--color-text-dim); }
        body.light-mode .nav-item a { color: var(--color-text-dim); }
        body.light-mode .active-page a { color: var(--color-text-light); }
        body.light-mode .progress-info { color: #333; }
        body.light-mode .progress-track { background-color: rgba(0,0,0,0.1); }
        body.light-mode .progress-fill { background-color: #4a90e2; }

        /* TOGGLE SWITCH */
        #dark-mode-toggle { display: flex; justify-content: space-between; align-items: center; cursor: default; }
        #dark-mode-toggle label { cursor: pointer; }
        .switch-container { position: relative; display: inline-block; width: 50px; height: 28px; }
        .switch-container input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #555; transition: .4s; }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: .4s; }
        .slider.round { border-radius: 34px; }
        .slider.round:before { border-radius: 50%; }
        input:checked + .slider { background-color: var(--color-accent-blue); }
        input:checked + .slider:before { transform: translateX(22px); }
        
        .no-classes { text-align: center; padding: 40px; color: var(--color-text-dim); font-style: italic; }
    </style>
</head>
<body>

    <div id="weather-app">
        <aside id="sidebar">
            <div id="station-header">
                <div class="logo-container"><span class="logo-text">ðŸ“…</span></div>
                <h1>Daily Timetable</h1>
            </div>
            <nav>
                <ul>
                    <li class="nav-item active-page"><a href="#">Timetable</a></li>
                    <li class="nav-item"><a href="#">Settings</a></li>
                </ul>
            </nav>
            <div id="info-section"><p>School Schedule</p></div>
            <div id="dark-mode-toggle">
                <label for="theme-switch">Light mode</label>
                <label class="switch-container">
                    <input type="checkbox" id="theme-switch">
                    <span class="slider round"></span>
                </label>
            </div>
        </aside>

        <main id="dashboard-content">
            <h2 id="day-header">Loading...</h2>
            <section id="alerts-container"><p>Loading timetable...</p></section>
        </main>
    </div>
    
    <script>
        const themeSwitch = document.getElementById('theme-switch');
        const body = document.body;
        function applyTheme(theme) {
            if (theme === 'light') {
                body.classList.add('light-mode');
                themeSwitch.checked = true;
            } else {
                body.classList.remove('light-mode');
                themeSwitch.checked = false;
            }
        }
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) { applyTheme(savedTheme); } else { applyTheme('dark'); }
        themeSwitch.addEventListener('change', function() {
            if (this.checked) {
                body.classList.add('light-mode');
                localStorage.setItem('theme', 'light');
            } else {
                body.classList.remove('light-mode');
                localStorage.setItem('theme', 'dark');
            }
        });
    </script>

    <script>
        // Embedded Data
        const timetable = [{"Day": "Monday", "Start Time": "08:05", "End Time": "08:43", "Subject": "Registration", "Teacher": "Miriam Rochford", "Location": "A14"}, {"Day": "Monday", "Start Time": "08:43", "End Time": "09:41", "Subject": "I Support", "Teacher": "Sophie Scanlan", "Location": "HB1"}, {"Day": "Monday", "Start Time": "09:41", "End Time": "10:39", "Subject": "English", "Teacher": "Michael Finucane", "Location": "A16"}, {"Day": "Monday", "Start Time": "10:39", "End Time": "10:59", "Subject": "Break", "Teacher": NaN, "Location": NaN}, {"Day": "Monday", "Start Time": "10:59", "End Time": "11:57", "Subject": "Science", "Teacher": "Lauren McGinn", "Location": "Check"}, {"Day": "Monday", "Start Time": "11:57", "End Time": "12:55", "Subject": "Home Ec", "Teacher": "Ciara Doherty", "Location": "L2"}, {"Day": "Monday", "Start Time": "12:55", "End Time": "13:35", "Subject": "Lunch", "Teacher": NaN, "Location": NaN}, {"Day": "Monday", "Start Time": "13:35", "End Time": "14:33", "Subject": "History", "Teacher": "C. O\u2019Reilly", "Location": "A14"}, {"Day": "Monday", "Start Time": "14:33", "End Time": "15:31", "Subject": "PE", "Teacher": "Niamh O\u2019Hare", "Location": "PE-1.2"}, {"Day": "Monday", "Start Time": "15:32", "End Time": "16:32", "Subject": "End of Day", "Teacher": NaN, "Location": NaN}, {"Day": "Tuesday", "Start Time": "08:05", "End Time": "08:43", "Subject": "Registration", "Teacher": "Miriam Rochford", "Location": "A14"}, {"Day": "Tuesday", "Start Time": "08:43", "End Time": "09:41", "Subject": "CSPE", "Teacher": "Sophie Gibbons", "Location": "TYHUB"}, {"Day": "Tuesday", "Start Time": "09:41", "End Time": "10:39", "Subject": "PE", "Teacher": "Niamh O\u2019Hare", "Location": "PE-1.2"}, {"Day": "Tuesday", "Start Time": "10:39", "End Time": "10:59", "Subject": "Break", "Teacher": NaN, "Location": NaN}, {"Day": "Tuesday", "Start Time": "10:59", "End Time": "11:57", "Subject": "German", "Teacher": "Jennifer Campbell", "Location": "S8"}, {"Day": "Tuesday", "Start Time": "11:57", "End Time": "12:55", "Subject": "Mathematics", "Teacher": "Stephen Grimes", "Location": "M26"}, {"Day": "Tuesday", "Start Time": "12:55", "End Time": "13:35", "Subject": "Lunch", "Teacher": NaN, "Location": NaN}, {"Day": "Tuesday", "Start Time": "13:35", "End Time": "14:33", "Subject": "SPHE", "Teacher": "Jenifer Campbell", "Location": "L5"}, {"Day": "Tuesday", "Start Time": "14:33", "End Time": "15:31", "Subject": "English", "Teacher": "Michael Finucane", "Location": "A16"}, {"Day": "Tuesday", "Start Time": "15:32", "End Time": "16:32", "Subject": "End of Day", "Teacher": NaN, "Location": NaN}, {"Day": "Wednesday", "Start Time": "08:05", "End Time": "08:43", "Subject": "Registration", "Teacher": "Miriam Rochford", "Location": "A14"}, {"Day": "Wednesday", "Start Time": "08:43", "End Time": "09:41", "Subject": "I Support", "Teacher": "Sophie Scanlan", "Location": "HB1"}, {"Day": "Wednesday", "Start Time": "09:41", "End Time": "10:39", "Subject": "Geography", "Teacher": "S. Gibbons", "Location": "HB7"}, {"Day": "Wednesday", "Start Time": "10:39", "End Time": "10:59", "Subject": "Break", "Teacher": NaN, "Location": NaN}, {"Day": "Wednesday", "Start Time": "10:59", "End Time": "11:57", "Subject": "English", "Teacher": "Michael Finucane", "Location": "A16"}, {"Day": "Wednesday", "Start Time": "11:57", "End Time": "12:55", "Subject": "Science", "Teacher": "Lauren McGinn", "Location": "Check"}, {"Day": "Wednesday", "Start Time": "12:55", "End Time": "13:35", "Subject": "Lunch", "Teacher": NaN, "Location": NaN}, {"Day": "Wednesday", "Start Time": "13:35", "End Time": "14:33", "Subject": "Early Half Day", "Teacher": NaN, "Location": NaN}, {"Day": "Wednesday", "Start Time": "14:33", "End Time": "15:31", "Subject": "Early Half Day", "Teacher": NaN, "Location": NaN}, {"Day": "Thursday", "Start Time": "08:05", "End Time": "08:43", "Subject": "Registration", "Teacher": "Miriam Rochford", "Location": "A14"}, {"Day": "Thursday", "Start Time": "08:43", "End Time": "09:41", "Subject": "Graphics", "Teacher": "D. O'Connor", "Location": "A20"}, {"Day": "Thursday", "Start Time": "09:41", "End Time": "10:39", "Subject": "Geography", "Teacher": "S. Gibbons", "Location": "HB7"}, {"Day": "Thursday", "Start Time": "10:39", "End Time": "10:59", "Subject": "Break", "Teacher": NaN, "Location": NaN}, {"Day": "Thursday", "Start Time": "10:59", "End Time": "11:57", "Subject": "Mathematics", "Teacher": "Stephen Grimes", "Location": "M26"}, {"Day": "Thursday", "Start Time": "11:57", "End Time": "12:55", "Subject": "I Support", "Teacher": "Sophie Scanlan", "Location": "A15"}, {"Day": "Thursday", "Start Time": "12:55", "End Time": "13:35", "Subject": "Lunch", "Teacher": NaN, "Location": NaN}, {"Day": "Thursday", "Start Time": "13:35", "End Time": "14:33", "Subject": "History", "Teacher": "C. O\u2019Reilly", "Location": "A15"}, {"Day": "Thursday", "Start Time": "14:33", "End Time": "15:31", "Subject": "German", "Teacher": "Jenifer Campbell", "Location": "S8"}, {"Day": "Friday", "Start Time": "08:05", "End Time": "08:43", "Subject": "Registration", "Teacher": "Miriam Rochford", "Location": "A14"}, {"Day": "Friday", "Start Time": "08:43", "End Time": "09:41", "Subject": "Mathematics", "Teacher": "Stephen Grimes", "Location": "M26"}, {"Day": "Friday", "Start Time": "09:41", "End Time": "10:39", "Subject": "History", "Teacher": "C. O\u2019Reilly", "Location": "A13"}, {"Day": "Friday", "Start Time": "10:39", "End Time": "10:59", "Subject": "Break", "Teacher": NaN, "Location": NaN}, {"Day": "Friday", "Start Time": "10:59", "End Time": "11:57", "Subject": "Geography", "Teacher": "S. Gibbons", "Location": "HB7"}, {"Day": "Friday", "Start Time": "11:57", "End Time": "12:55", "Subject": "Graphics", "Teacher": "D. O'Connor", "Location": "A20"}, {"Day": "Friday", "Start Time": "12:55", "End Time": "13:35", "Subject": "Lunch", "Teacher": NaN, "Location": NaN}, {"Day": "Friday", "Start Time": "13:35", "End Time": "14:33", "Subject": "Computing", "Teacher": "Joanne Hanratty", "Location": "S12"}, {"Day": "Friday", "Start Time": "14:33", "End Time": "15:31", "Subject": "Home Ec", "Teacher": "Ciara Doherty", "Location": "L2"}];

        const STATUS_COLORS = {
            'DONE': '#38B000',    // Green
            'CURRENT': '#FFFFFF', // White
            'FUTURE': '#FF0000'   // Red
        };

        function getDayName() {
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            return days[new Date().getDay()];
        }

        function parseTime(timeStr) {
            if (!timeStr) return null;
            const [hours, minutes] = timeStr.split(':').map(Number);
            const now = new Date();
            return new Date(now.getFullYear(), now.getMonth(), now.getDate(), hours, minutes);
        }

        function renderTimetable() {
            const currentDay = getDayName();
            document.getElementById('day-header').innerText = currentDay + "'s Timetable";
            
            const container = document.getElementById('alerts-container');
            container.innerHTML = '';

            const todaysSubjects = timetable.filter(item => item.Day === currentDay);

            if (todaysSubjects.length === 0) {
                container.innerHTML = '<div class="no-classes">No classes scheduled for today.</div>';
                return;
            }

            const now = new Date();

            todaysSubjects.forEach(item => {
                const startTime = parseTime(item['Start Time']);
                const endTime = parseTime(item['End Time']);
                
                let status = 'FUTURE';
                let levelLabel = 'UPCOMING';
                let progressHtml = '';
                
                if (now > endTime) {
                    status = 'DONE';
                    levelLabel = 'COMPLETED';
                } else if (now >= startTime && now <= endTime) {
                    status = 'CURRENT';
                    levelLabel = 'IN PROGRESS';
                    
                    // --- PROGRESS LOGIC ---
                    const totalDuration = (endTime - startTime);
                    const elapsed = (now - startTime);
                    const percentage = Math.max(0, Math.min(100, (elapsed / totalDuration) * 100));
                    const remainingMs = totalDuration - elapsed;
                    const remainingMins = Math.ceil(remainingMs / (1000 * 60));
                    
                    progressHtml = `
                        <div class="progress-section">
                            <div class="progress-info">
                                <span>Time left: ${remainingMins} min</span>
                                <span>${Math.round(percentage)}%</span>
                            </div>
                            <div class="progress-track">
                                <div class="progress-fill" style="width: ${percentage}%;"></div>
                            </div>
                        </div>
                    `;
                }

                const color = STATUS_COLORS[status];
                
                // Text color logic
                let textColor = '#FFF';
                if (status === 'CURRENT' || status === 'DONE') {
                    textColor = '#000';
                }

                const teacher = item.Teacher && item.Teacher !== 'nan' ? `Teacher: ${item.Teacher}` : '';
                const location = item.Location && item.Location !== 'nan' ? `Location: ${item.Location}` : '';
                const detailsText = [teacher, location].filter(Boolean).join(' | ');

                const alertHtml = `
                    <div class="alert-card" style="border-color: ${color};">
                        <div class="alert-header">
                            <span class="alert-level" style="background-color: ${color}; color: ${textColor};">${levelLabel}</span>
                            <div class="alert-times">
                                <strong>Start:</strong> ${item['Start Time']} &bull; <strong>End:</strong> ${item['End Time']}
                            </div>
                        </div>
                        <div class="alert-headline">${item.Subject}</div>
                        <div class="alert-details">
                            <p>${detailsText}</p>
                            ${progressHtml}
                        </div>
                    </div>
                `;
                
                container.insertAdjacentHTML('beforeend', alertHtml);
            });
        }

        renderTimetable();
        setInterval(renderTimetable, 60000); // Update every minute
    </script>
</body>
</html>